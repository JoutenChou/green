var pageType="basepage";$(document).ready(function(){Body.hasClass("productdetail")&&$.productSpec(),$.fancyboxFunc(),$.updateCaptcha(),$.sendContact(),$.sideNav(),$.resizeSide(),$.sharebtn(),$.ldTip(),$.searchProduct(),$.banner()}),function(t){t.updateCaptcha=function(){t("#captcha").click(function(){var n=new Date;t(this).attr("src","/captcha.php?"+n.getMilliseconds())})}}(jQuery),function(t){function n(){var n="",a=/[\w-]+@([\w-]+\.)+[\w-]+/;return t("input[name='requireField[]']").each(function(){var a=t(this).val();""===t("input[name="+a+"]").val()&&(n+=a+"不可以是空白。\n"),""===t("textarea[name="+a+"]").val()&&(n+=a+"不可以是空白。\n")}),""!==t("#mail").val()&&a.test(t("#mail").val())!==!0&&(n+="信箱格式錯誤。\n"),""===t("input[name=f_d_authcode]").val()?n+="驗證碼不可以是空白。\n":t("#statepic").hasClass("success")||(n+="驗證碼錯誤。\n"),""===n||(alert(n),!1)}function a(){var n={t:"t",f:"d_captcha",f_d_authcode:t("input[name=f_d_authcode]").val()};t.ajax({type:"POST",url:location.pathname,dataType:"json",data:t.param(n),async:!1,beforeSend:function(){t("#state").html("<img src='/templates/images/loading.gif' class='error ajaxloading' style='vertical-align:middle;'>")},success:function(n){"success"==n.state?t("#state").html("<img id='statepic' src='/templates/images/captcha-right.png' class='success' style='vertical-align:middle;'>"):t("#state").html("<img id='statepic' src='/templates/images/captcha-error.png' class='error' style='vertical-align:middle;'>")},timeout:1e4})}t.sendContact=function(){t("#contact-form").submit(function(){return n()}),t("#authcode").blur(function(){a()})}}(jQuery),function(t){function n(){var n={t:"t",f:"d_getspecpanel"};t.ajax({type:"POST",url:window.location.pathname,dataType:"json",data:t.param(n),async:!1,success:function(n){var i=t("<div/>",{"class":"dd"});if(n.inves.length>1||"無規格"!==n.inves[0].spec){var c=t("<ol/>");t.each(n.inves,function(t,n){n.qty>0?(0===c.find("li.current").length&&(o=n.qty),c.append('<li data-inveid="{0}" {2}>{1}</li>'.format(n.id,n.spec,0===c.find("li.current").length?'class="current"':""))):c.append('<li data-inveid="{0}" title="缺貨" data-toggle="tooltip">{1}</li>'.format(n.id,n.spec))}),t("<li/>",{"class":"model"}).append("<b>"+n.lang.specification+"</b>").append(i.clone().attr("id","model-li").append(c)).insertBefore("#shopping-pay-way,#size-info,#shopping-means")}else o=n.inves[0].qty;if(0!==n.open){var s=t('<li class="quantity"><b>'+n.lang.quantity+'</b>                                        <div class="dd">                                            <input type="number" id="quantity" class="input-quantity" value="1" min="1">                                            <b>'+n.lang.inventory+'</b>                                            <span id="inventory"></span>                                        </div>                                    </li>                                    <li class="shopping-cart-btns">                                    </li>').insertBefore("#shopping-pay-way,#size-info,#shopping-means");r={quantityInput:s.find("#quantity"),inventory:s.find("#inventory"),cartBtn:t(".shopping-cart-btns")},a(n)}e(),i=null}})}function a(t){r.quantityInput.attr("max",o).prop("disabled",0===o),r.inventory.text(o),o>0&&2==t.open?r.cartBtn.html(c.prepare+" "+c.wantTrack):o>0?r.cartBtn.html(c.addCart+" "+c.wantTrack):0===o?r.cartBtn.html(c.empty+" "+c.waitTrack):r.cartBtn.html(c.empty+" "+c.wantTrack)}function e(){t(".shopping-cart-btns").on("click","#add-to-cart",function(){return s.addtoCart(),!1}),t(".shopping-cart-btns").on("click","#add-want-track",function(){return s.addToTrack("want"),!1}),t(".shopping-cart-btns").on("click","#add-wait-track",function(){return s.addToTrack("wait"),!1}),t("#model-li").find("li").click(function(n){var a=t(this);if(!a.hasClass("current"))return i(n),!1})}function i(n){var e;e=void 0===n?t("#model-li li.current").data("inveid"):t(n.target).data("inveid");var i={t:"t",f:"d_getinventory",f_d_invid:e};t.ajax({type:"POST",url:window.location.pathname,dataType:"json",data:t.param(i),async:!1,success:function(e){void 0!==n&&t(n.target).addClass("current").siblings().removeClass("current"),o=e.inventory,a(e)}})}var c={addCart:'<button type="button" id="add-to-cart" class="btn btn-cart"><i class="fa fa-shopping-cart fa-lg"></i> 放入購物車</button>',wantTrack:'<button type="button" id="add-want-track" class="btn btn-default">加入追蹤清單</button>',waitTrack:'<button type="button" id="add-wait-track" class="btn btn-default">加入到貨通知</button>',prepare:'<button type="button" class="btn btn-info" disabled="disabled">商品準備中</button>',empty:'<button type="button" class="btn btn-info" disabled="disabled">商品補貨中</button>'},r={},o=0,s={addtoCart:function(){if(t("#model-1").length>0&&t("#model-1 li.current").length<1)return e7notice("請選取商品規格","error"),!1;var n={t:"t",f:"d_getssluri"};t.ajax({type:"POST",url:window.location.pathname,dataType:"json",data:t.param(n),success:function(n){t("<form/>").attr({method:"POST",action:n.location}).append('<input type="hidden" name="t" value="t">').append('<input type="hidden" name="f" value="d_addtocart">').append('<input type="hidden" name="f_d_invid" value="'+t("#model-li li.current").attr("data-inveid")+'">').append('<input type="hidden" name="f_d_quantity" value="'+t("#quantity").val()+'">').appendTo(document.body).submit()}})},addToTrack:function(n){var a={t:"t",f:"d_addtotrack",f_d_tracktype:n,f_d_invid:t("#model-li li.current").data("inveid")};t.ajax({type:"POST",url:window.location.pathname,dataType:"json",data:t.param(a),async:!1,success:function(n){"success"===n.state?(t("#track-list").find(".badge").text(n.count),e7notice("商品已加入追蹤清單","success")):e7notice(n.error,"error")}})}};t.productSpec=function(){n()},t.extend(t.productSpec,{refreshModels:i})}(jQuery),function(t){(t("#bodyinpage").hasClass("product")||t("#bodyinpage").hasClass("shopping")||t("#bodyinpage").hasClass("globalshopping"))&&(pageType="fullpage"),t.sideNav=function(){t(".side-content").find(".children").prev("div").append("<span></span>").end().css({maxHeight:function(){var n=0;return t(this).find("li").each(function(){n+=t(this).outerHeight(!0)}),n?n+"px":"none"},transition:function(){return"max-height "+.1*t(this).find("li").length+"s cubic-bezier(0.15, 0, 0.15, 1)"}}).end().find(".current").addClass("open").parents("li").addClass("open").end().end().one("transitionend",function(){t.resizeSide()}).find("span").bind(Mouse.CLICK,function(){t(this).closest("li").toggleClass("open"),t(".side-content").one("transitionend",function(){t.resizeSide()})})}}(jQuery),function(t){t.resizeSide=function(){if(t(".side-content").length){const n=43,a=t(".side-content")[0].clientHeight+n;t(".fcol-1").length>0?t(".editor-height").css({minHeight:a}):t(".display-height").css({minHeight:a})}}}(jQuery),function(t){t.openQA=function(){t("#inquiry-btn").click(function(){return t("#inquiry-div").toggle(),!1}),t("#close-inquiry-div").click(function(){return t("#inquiry-div").hide(),!1});var n=t("#inquiry-div textarea").val();t("#inquiry-div textarea").focus(function(){t(this).val()==n&&t(this).val("").css("color","#000")}),t("#inquiry-div textarea").blur(function(){""===t(this).val()&&t(this).val(n).css("color","#777")})}}(jQuery),function(t){t.sharebtn=function(){t(".sharebtn").each(function(){t(this).click(function(){return t(this).hasClass("facebook")?window.open("http://www.facebook.com/share.php?u=".concat(encodeURIComponent(location.href))):t(this).hasClass("twitter")?window.open("http://twitter.com/home/?status=".concat(encodeURIComponent(document.title)).concat(" ").concat(encodeURIComponent(location.href))):t(this).hasClass("plurk")&&window.open("http://www.plurk.com/?qualifier=shares&amp;status=".concat(encodeURIComponent(location.href)).concat(" ").concat("(").concat(encodeURIComponent(document.title)).concat(")")),!1})})}}(jQuery),function(t){function n(){t("#product-search-modal").modal()}function a(n){var a=!1;if("keypress"===n.type){var i="which"in n?n.which:n.keyCode;13===i&&(s=t(n.currentTarget).val(),a=!0)}"click"===n.type&&(s=t(n.currentTarget).prev("input").val(),a=!0),a===!0&&"product-keyword"!==t(n.currentTarget).attr("id")&&(t("#product-search-main #product-keyword").val(s),t("#product-search-cates").empty(),t("#product-serach-msg").empty(),t("#product-search-result").empty(),t("#product-search-modal").modal("show"),t("#product-search-modal").on("shown.bs.modal",function(){e(s)})),a===!0&&"product-keyword"===t(n.currentTarget).attr("id")&&e(s)}function e(n){t("#product-serach-loading").removeClass("hidden"),t("#product-search-cates").empty(),t("#product-serach-msg").empty(),t("#product-search-result").empty(),"object"==typeof n&&(n=t("#product-search-main #product-keyword").val()),setTimeout(function(){c(n)},100)}function i(n){n.preventDefault(),t.each(t(".list-group-item"),function(n,a){t(a).removeClass("active")}),t(n.currentTarget).addClass("active");var a=t(n.currentTarget).attr("data");if(void 0!==o.cates[a]){var e=t.extend({},o);e.cates={_cateId:e.cates[a]};var i=r(e);return void t("#product-search-result").empty().append(i)}var i=r(o);t("#product-search-result").empty().append(i)}function c(n){var a={t:"t",f:"d_getsearchresult",f_d_keyword:n};n?t.ajax({type:"POST",url:location.pathname,dataType:"json",data:t.param(a),async:!1,success:function(a){var e="",i="",c="「{0}」的搜尋結果 共 {1} 筆資料";if("success"===a.status&&void 0!==a.count){var s=t.extend({0:{id:"all",count:a.count,name:"全部結果"}},a.cates);t.each(s,function(n,a){var e='<a class="list-group-item" data="{0}" href="#">                                           <span class="badge">{1}</span> {2}                                           </a>';e=e.format(a.id,a.count,a.name),i+=e,t("#product-search-cates").html(i)}),c=c.format(n,a.count),t("#product-serach-msg").html(c),e=r(a),t("#product-search-result").html(e),o=a}"success"===a.status&&void 0===a.count&&(c=c.format(n,0),t("#product-serach-msg").html(c)),t("#product-serach-loading").addClass("hidden"),t.RWDNavToggle.hide()}}):Alert("請輸入關鍵字")}function r(n){var a="";return t.each(n.cates,function(n,e){t.each(e.products,function(t,n){var e='<li class="media">                                   <a href="{0}">                                       <div class="row">                                           <div class="col-xs-5 col-md-3">                                               <div class="media-img">                                                   <img src="{1}">                                               </div>                                           </div>                                           <div class="col-xs-7 col-md-9">                                               <h4>{2}</h4>                                           </div>                                       </div>                                   </a>                               </li>';e=e.format(n.filename,n.photo,n.name,n.price),a+=e})}),a}var o="",s="";t.searchProduct=function(){t(".searchbox").on("click",n),t("#product-search-main").on("click",'[type="submit"]',e),t("#product-search-main").on("keypress",'[type="text"]',a),t(".product-search").on("keypress",'[type="text"]',a),t(".product-search").on("click",'[type="submit"]',a),t("#product-search-cates").on("click","a.list-group-item",i)}}(jQuery),function(t){t.banner=function(){bannerGen.initIsPremium(),t("#banner > #banner-flash").length?bannerGen.flash():t("#banner > #banner-img").length&&bannerGen.swiper()}}(jQuery);